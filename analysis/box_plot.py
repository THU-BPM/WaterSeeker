kgw_start_offset = [{'strength': 2.0, 'offset': 11}, {'strength': 2.0, 'offset': 14}, {'strength': 2.0, 'offset': 34}, {'strength': 1.5, 'offset': 9}, {'strength': 2.0, 'offset': 20}, {'strength': 1.5, 'offset': 9}, {'strength': 1.5, 'offset': 13}, {'strength': 1.5, 'offset': 97}, {'strength': 1.0, 'offset': -65}, {'strength': 1.5, 'offset': 19}, {'strength': 2.0, 'offset': 35}, {'strength': 2.0, 'offset': 5}, {'strength': 1.5, 'offset': 29}, {'strength': 1.0, 'offset': 4}, {'strength': 2.0, 'offset': 9}, {'strength': 1.0, 'offset': -4}, {'strength': 1.5, 'offset': 69}, {'strength': 1.0, 'offset': 128}, {'strength': 2.0, 'offset': 13}, {'strength': 1.0, 'offset': 20}, {'strength': 1.5, 'offset': -42}, {'strength': 1.0, 'offset': 113}, {'strength': 1.5, 'offset': -9}, {'strength': 1.5, 'offset': -21}, {'strength': 2.0, 'offset': 28}, {'strength': 1.0, 'offset': -36}, {'strength': 1.5, 'offset': -78}, {'strength': 1.0, 'offset': 37}, {'strength': 2.0, 'offset': 17}, {'strength': 2.0, 'offset': 20}, {'strength': 1.0, 'offset': 9}, {'strength': 1.5, 'offset': 35}, {'strength': 2.0, 'offset': 15}, {'strength': 1.5, 'offset': 22}, {'strength': 2.0, 'offset': 6}, {'strength': 1.0, 'offset': 24}, {'strength': 2.0, 'offset': 24}, {'strength': 2.0, 'offset': 21}, {'strength': 2.0, 'offset': 15}, {'strength': 1.5, 'offset': 33}, {'strength': 1.5, 'offset': 28}, {'strength': 2.0, 'offset': 151}, {'strength': 2.0, 'offset': 1}, {'strength': 1.0, 'offset': 4}, {'strength': 1.5, 'offset': 26}, {'strength': 1.0, 'offset': 20}, {'strength': 1.5, 'offset': 38}, {'strength': 2.0, 'offset': 26}, {'strength': 1.0, 'offset': 4}, {'strength': 2.0, 'offset': -1}, {'strength': 1.5, 'offset': 113}, {'strength': 1.0, 'offset': 17}, {'strength': 2.0, 'offset': 10}, {'strength': 2.0, 'offset': 18}, {'strength': 1.5, 'offset': 30}, {'strength': 2.0, 'offset': 29}, {'strength': 2.0, 'offset': 35}, {'strength': 1.0, 'offset': -11}, {'strength': 2.0, 'offset': -31}, {'strength': 2.0, 'offset': -14}, {'strength': 1.0, 'offset': 16}, {'strength': 1.0, 'offset': 113}, {'strength': 1.5, 'offset': 13}, {'strength': 1.5, 'offset': 25}, {'strength': 2.0, 'offset': 28}, {'strength': 1.5, 'offset': 26}, {'strength': 2.0, 'offset': 8}, {'strength': 1.5, 'offset': 17}, {'strength': 1.5, 'offset': 99}, {'strength': 1.5, 'offset': 10}, {'strength': 2.0, 'offset': 2}, {'strength': 1.0, 'offset': 49}, {'strength': 2.0, 'offset': 11}, {'strength': 1.0, 'offset': 10}, {'strength': 1.5, 'offset': -6}, {'strength': 2.0, 'offset': 7}, {'strength': 1.0, 'offset': 15}, {'strength': 1.0, 'offset': 52}, {'strength': 2.0, 'offset': 12}, {'strength': 2.0, 'offset': 10}, {'strength': 2.0, 'offset': 16}, {'strength': 2.0, 'offset': 10}, {'strength': 1.5, 'offset': 31}, {'strength': 1.5, 'offset': 17}, {'strength': 1.5, 'offset': 22}, {'strength': 1.5, 'offset': 20}, {'strength': 1.5, 'offset': 4}, {'strength': 2.0, 'offset': 19}, {'strength': 1.5, 'offset': 4}, {'strength': 1.5, 'offset': 21}, {'strength': 1.5, 'offset': -5}, {'strength': 1.0, 'offset': 66}, {'strength': 1.5, 'offset': 5}, {'strength': 2.0, 'offset': 12}, {'strength': 2.0, 'offset': 25}, {'strength': 1.5, 'offset': 122}, {'strength': 1.5, 'offset': 23}, {'strength': 1.5, 'offset': 91}, {'strength': 2.0, 'offset': 29}, {'strength': 1.0, 'offset': 13}, {'strength': 1.5, 'offset': -34}, {'strength': 2.0, 'offset': 10}, {'strength': 1.5, 'offset': -16}, {'strength': 1.5, 'offset': 23}, {'strength': 2.0, 'offset': 24}, {'strength': 1.5, 'offset': 15}, {'strength': 2.0, 'offset': -1}, {'strength': 1.0, 'offset': 25}, {'strength': 2.0, 'offset': 16}, {'strength': 1.5, 'offset': 21}, {'strength': 1.0, 'offset': 3}, {'strength': 1.5, 'offset': 30}, {'strength': 1.5, 'offset': 40}, {'strength': 2.0, 'offset': 15}, {'strength': 1.0, 'offset': 142}, {'strength': 2.0, 'offset': -1}, {'strength': 1.5, 'offset': 19}, {'strength': 1.0, 'offset': 105}, {'strength': 2.0, 'offset': 21}, {'strength': 1.5, 'offset': 19}, {'strength': 1.5, 'offset': -5}, {'strength': 1.5, 'offset': 16}, {'strength': 1.5, 'offset': 9}, {'strength': 1.0, 'offset': -18}, {'strength': 1.5, 'offset': 12}, {'strength': 1.5, 'offset': 9}, {'strength': 2.0, 'offset': 0}, {'strength': 1.0, 'offset': 8}, {'strength': 2.0, 'offset': 35}, {'strength': 2.0, 'offset': 18}, {'strength': 1.5, 'offset': -59}, {'strength': 1.5, 'offset': 21}, {'strength': 1.5, 'offset': 23}, {'strength': 2.0, 'offset': 39}, {'strength': 1.5, 'offset': 18}, {'strength': 1.5, 'offset': -66}, {'strength': 1.5, 'offset': 93}, {'strength': 1.5, 'offset': 16}, {'strength': 2.0, 'offset': 17}, {'strength': 2.0, 'offset': 24}, {'strength': 1.0, 'offset': 21}, {'strength': 2.0, 'offset': -7}, {'strength': 2.0, 'offset': -34}, {'strength': 2.0, 'offset': 37}, {'strength': 2.0, 'offset': 30}, {'strength': 2.0, 'offset': 16}, {'strength': 2.0, 'offset': -1}, {'strength': 1.5, 'offset': 18}, {'strength': 1.5, 'offset': 143}, {'strength': 1.0, 'offset': -45}, {'strength': 1.5, 'offset': -21}, {'strength': 2.0, 'offset': 24}, {'strength': 2.0, 'offset': 14}, {'strength': 1.0, 'offset': 23}, {'strength': 1.0, 'offset': 28}, {'strength': 1.0, 'offset': 4}, {'strength': 2.0, 'offset': 48}, {'strength': 1.5, 'offset': 9}, {'strength': 2.0, 'offset': 3}, {'strength': 2.0, 'offset': 4}, {'strength': 2.0, 'offset': 42}, {'strength': 2.0, 'offset': 30}, {'strength': 2.0, 'offset': 16}, {'strength': 2.0, 'offset': 7}, {'strength': 2.0, 'offset': 18}, {'strength': 2.0, 'offset': 18}, {'strength': 1.0, 'offset': 0}, {'strength': 1.5, 'offset': 20}, {'strength': 1.5, 'offset': 31}, {'strength': 2.0, 'offset': 15}, {'strength': 1.0, 'offset': 99}, {'strength': 1.5, 'offset': 19}, {'strength': 1.5, 'offset': 13}, {'strength': 1.0, 'offset': 23}, {'strength': 1.5, 'offset': 13}, {'strength': 2.0, 'offset': 5}, {'strength': 1.5, 'offset': 8}, {'strength': 1.0, 'offset': -11}, {'strength': 1.5, 'offset': 25}, {'strength': 2.0, 'offset': 14}, {'strength': 1.5, 'offset': 44}, {'strength': 1.5, 'offset': -48}, {'strength': 2.0, 'offset': 27}, {'strength': 2.0, 'offset': 29}, {'strength': 2.0, 'offset': 19}, {'strength': 1.0, 'offset': 167}, {'strength': 1.0, 'offset': 26}, {'strength': 1.5, 'offset': 11}, {'strength': 2.0, 'offset': 79}, {'strength': 2.0, 'offset': 1}, {'strength': 1.0, 'offset': 15}, {'strength': 2.0, 'offset': 31}, {'strength': 2.0, 'offset': 7}, {'strength': 2.0, 'offset': 13}, {'strength': 2.0, 'offset': 16}, {'strength': 2.0, 'offset': 29}, {'strength': 2.0, 'offset': 37}, {'strength': 2.0, 'offset': -3}, {'strength': 2.0, 'offset': 15}, {'strength': 1.5, 'offset': 21}, {'strength': 2.0, 'offset': 35}, {'strength': 2.0, 'offset': 11}, {'strength': 1.0, 'offset': 19}, {'strength': 1.5, 'offset': 10}, {'strength': 1.5, 'offset': 75}, {'strength': 1.0, 'offset': -132}, {'strength': 2.0, 'offset': 11}, {'strength': 1.5, 'offset': 26}]
kgw_end_offset = [{'strength': 2.0, 'offset': 19}, {'strength': 2.0, 'offset': 22}, {'strength': 2.0, 'offset': 14}, {'strength': 1.5, 'offset': 197}, {'strength': 2.0, 'offset': 11}, {'strength': 1.5, 'offset': 26}, {'strength': 1.5, 'offset': 21}, {'strength': 1.5, 'offset': 27}, {'strength': 1.0, 'offset': -6}, {'strength': 1.5, 'offset': 7}, {'strength': 2.0, 'offset': 20}, {'strength': 2.0, 'offset': 32}, {'strength': 1.5, 'offset': 6}, {'strength': 1.0, 'offset': 2}, {'strength': 2.0, 'offset': 19}, {'strength': 1.0, 'offset': 24}, {'strength': 1.5, 'offset': 31}, {'strength': 1.0, 'offset': -83}, {'strength': 2.0, 'offset': 14}, {'strength': 1.0, 'offset': -11}, {'strength': 1.5, 'offset': 11}, {'strength': 1.0, 'offset': 63}, {'strength': 1.5, 'offset': 33}, {'strength': 1.5, 'offset': 33}, {'strength': 2.0, 'offset': 29}, {'strength': 1.0, 'offset': -6}, {'strength': 1.5, 'offset': 1}, {'strength': 1.0, 'offset': 13}, {'strength': 2.0, 'offset': 39}, {'strength': 2.0, 'offset': 24}, {'strength': 1.0, 'offset': -20}, {'strength': 1.5, 'offset': 14}, {'strength': 2.0, 'offset': 7}, {'strength': 1.5, 'offset': -10}, {'strength': 2.0, 'offset': 21}, {'strength': 1.0, 'offset': 126}, {'strength': 2.0, 'offset': 15}, {'strength': 2.0, 'offset': 77}, {'strength': 2.0, 'offset': 17}, {'strength': 1.5, 'offset': 10}, {'strength': 1.5, 'offset': 18}, {'strength': 2.0, 'offset': 27}, {'strength': 2.0, 'offset': 13}, {'strength': 1.0, 'offset': 22}, {'strength': 1.5, 'offset': 22}, {'strength': 1.0, 'offset': 51}, {'strength': 1.5, 'offset': 31}, {'strength': 2.0, 'offset': 16}, {'strength': 1.0, 'offset': -6}, {'strength': 2.0, 'offset': 21}, {'strength': 1.5, 'offset': -12}, {'strength': 1.0, 'offset': 40}, {'strength': 2.0, 'offset': 14}, {'strength': 2.0, 'offset': 7}, {'strength': 1.5, 'offset': -21}, {'strength': 2.0, 'offset': 17}, {'strength': 2.0, 'offset': 29}, {'strength': 1.0, 'offset': 23}, {'strength': 2.0, 'offset': 12}, {'strength': 2.0, 'offset': 12}, {'strength': 1.0, 'offset': 18}, {'strength': 1.0, 'offset': 22}, {'strength': 1.5, 'offset': 5}, {'strength': 1.5, 'offset': 3}, {'strength': 2.0, 'offset': 17}, {'strength': 1.5, 'offset': 36}, {'strength': 2.0, 'offset': 1}, {'strength': 1.5, 'offset': 9}, {'strength': 1.5, 'offset': 11}, {'strength': 1.5, 'offset': 22}, {'strength': 2.0, 'offset': 9}, {'strength': 1.0, 'offset': 17}, {'strength': 2.0, 'offset': 25}, {'strength': 1.0, 'offset': 171}, {'strength': 1.5, 'offset': 23}, {'strength': 2.0, 'offset': 33}, {'strength': 1.0, 'offset': 27}, {'strength': 1.0, 'offset': 17}, {'strength': 2.0, 'offset': 12}, {'strength': 2.0, 'offset': 5}, {'strength': 2.0, 'offset': 24}, {'strength': 2.0, 'offset': 25}, {'strength': 1.5, 'offset': 24}, {'strength': 1.5, 'offset': 12}, {'strength': 1.5, 'offset': 22}, {'strength': 1.5, 'offset': 12}, {'strength': 1.5, 'offset': -145}, {'strength': 2.0, 'offset': 24}, {'strength': 1.5, 'offset': 9}, {'strength': 1.5, 'offset': 31}, {'strength': 1.5, 'offset': 5}, {'strength': 1.0, 'offset': 26}, {'strength': 1.5, 'offset': 16}, {'strength': 2.0, 'offset': 13}, {'strength': 2.0, 'offset': 20}, {'strength': 1.5, 'offset': 48}, {'strength': 1.5, 'offset': -11}, {'strength': 1.5, 'offset': -60}, {'strength': 2.0, 'offset': -11}, {'strength': 1.0, 'offset': 19}, {'strength': 1.5, 'offset': 14}, {'strength': 2.0, 'offset': 6}, {'strength': 1.5, 'offset': 8}, {'strength': 1.5, 'offset': 18}, {'strength': 2.0, 'offset': 1}, {'strength': 1.5, 'offset': 88}, {'strength': 2.0, 'offset': 37}, {'strength': 1.0, 'offset': -16}, {'strength': 2.0, 'offset': 9}, {'strength': 1.5, 'offset': 5}, {'strength': 1.0, 'offset': 38}, {'strength': 1.5, 'offset': 42}, {'strength': 1.5, 'offset': 11}, {'strength': 2.0, 'offset': 12}, {'strength': 1.0, 'offset': 71}, {'strength': 2.0, 'offset': -113}, {'strength': 1.5, 'offset': -36}, {'strength': 1.0, 'offset': 28}, {'strength': 2.0, 'offset': 26}, {'strength': 1.5, 'offset': -3}, {'strength': 1.5, 'offset': 20}, {'strength': 1.5, 'offset': 18}, {'strength': 1.5, 'offset': 95}, {'strength': 1.0, 'offset': -32}, {'strength': 1.5, 'offset': -14}, {'strength': 1.5, 'offset': 47}, {'strength': 2.0, 'offset': -9}, {'strength': 1.0, 'offset': -169}, {'strength': 2.0, 'offset': 28}, {'strength': 2.0, 'offset': 19}, {'strength': 1.5, 'offset': -13}, {'strength': 1.5, 'offset': -28}, {'strength': 1.5, 'offset': 7}, {'strength': 2.0, 'offset': 6}, {'strength': 1.5, 'offset': -1}, {'strength': 1.5, 'offset': -37}, {'strength': 1.5, 'offset': 28}, {'strength': 1.5, 'offset': 5}, {'strength': 2.0, 'offset': 10}, {'strength': 2.0, 'offset': 19}, {'strength': 1.0, 'offset': 11}, {'strength': 2.0, 'offset': 3}, {'strength': 2.0, 'offset': 7}, {'strength': 2.0, 'offset': 13}, {'strength': 2.0, 'offset': 7}, {'strength': 2.0, 'offset': 25}, {'strength': 2.0, 'offset': 26}, {'strength': 1.5, 'offset': 28}, {'strength': 1.5, 'offset': 21}, {'strength': 1.0, 'offset': 15}, {'strength': 1.5, 'offset': 20}, {'strength': 2.0, 'offset': 31}, {'strength': 2.0, 'offset': 21}, {'strength': 1.0, 'offset': 17}, {'strength': 1.0, 'offset': 172}, {'strength': 1.0, 'offset': -43}, {'strength': 2.0, 'offset': 28}, {'strength': 1.5, 'offset': 35}, {'strength': 2.0, 'offset': 22}, {'strength': 2.0, 'offset': 14}, {'strength': 2.0, 'offset': -27}, {'strength': 2.0, 'offset': 19}, {'strength': 2.0, 'offset': 27}, {'strength': 2.0, 'offset': 92}, {'strength': 2.0, 'offset': 26}, {'strength': 2.0, 'offset': 16}, {'strength': 1.0, 'offset': 48}, {'strength': 1.5, 'offset': 13}, {'strength': 1.5, 'offset': 12}, {'strength': 2.0, 'offset': 18}, {'strength': 1.0, 'offset': 32}, {'strength': 1.5, 'offset': 5}, {'strength': 1.5, 'offset': 25}, {'strength': 1.0, 'offset': 12}, {'strength': 1.5, 'offset': 16}, {'strength': 2.0, 'offset': 16}, {'strength': 1.5, 'offset': 16}, {'strength': 1.0, 'offset': 1}, {'strength': 1.5, 'offset': 6}, {'strength': 2.0, 'offset': 12}, {'strength': 1.5, 'offset': 1}, {'strength': 1.5, 'offset': 29}, {'strength': 2.0, 'offset': 16}, {'strength': 2.0, 'offset': 15}, {'strength': 2.0, 'offset': 4}, {'strength': 1.0, 'offset': 18}, {'strength': 1.0, 'offset': 11}, {'strength': 1.5, 'offset': 11}, {'strength': 2.0, 'offset': 10}, {'strength': 2.0, 'offset': 27}, {'strength': 1.0, 'offset': 1}, {'strength': 2.0, 'offset': 8}, {'strength': 2.0, 'offset': 23}, {'strength': 2.0, 'offset': 16}, {'strength': 2.0, 'offset': 14}, {'strength': 2.0, 'offset': -13}, {'strength': 2.0, 'offset': 19}, {'strength': 2.0, 'offset': 14}, {'strength': 2.0, 'offset': 7}, {'strength': 1.5, 'offset': 24}, {'strength': 2.0, 'offset': 1}, {'strength': 2.0, 'offset': 29}, {'strength': 1.0, 'offset': 8}, {'strength': 1.5, 'offset': 21}, {'strength': 1.5, 'offset': 34}, {'strength': 1.0, 'offset': -4}, {'strength': 2.0, 'offset': 2}, {'strength': 1.5, 'offset': 5}]

aar_start_offset = [{'strength': 0.4, 'offset': 33}, {'strength': 0.4, 'offset': 21}, {'strength': 0.3, 'offset': 32}, {'strength': 0.3, 'offset': -4}, {'strength': 0.5, 'offset': 3}, {'strength': 0.5, 'offset': 11}, {'strength': 0.5, 'offset': 17}, {'strength': 0.4, 'offset': 94}, {'strength': 0.3, 'offset': 12}, {'strength': 0.5, 'offset': 15}, {'strength': 0.5, 'offset': 15}, {'strength': 0.5, 'offset': 36}, {'strength': 0.5, 'offset': 23}, {'strength': 0.5, 'offset': 18}, {'strength': 0.3, 'offset': 22}, {'strength': 0.5, 'offset': -24}, {'strength': 0.5, 'offset': 16}, {'strength': 0.5, 'offset': 18}, {'strength': 0.4, 'offset': -69}, {'strength': 0.4, 'offset': -15}, {'strength': 0.3, 'offset': 16}, {'strength': 0.5, 'offset': 36}, {'strength': 0.3, 'offset': -2}, {'strength': 0.3, 'offset': -1}, {'strength': 0.4, 'offset': 17}, {'strength': 0.5, 'offset': 15}, {'strength': 0.5, 'offset': 17}, {'strength': 0.3, 'offset': 14}, {'strength': 0.3, 'offset': 4}, {'strength': 0.5, 'offset': 29}, {'strength': 0.5, 'offset': -27}, {'strength': 0.5, 'offset': 51}, {'strength': 0.4, 'offset': 25}, {'strength': 0.4, 'offset': 15}, {'strength': 0.3, 'offset': 47}, {'strength': 0.5, 'offset': 24}, {'strength': 0.3, 'offset': 58}, {'strength': 0.5, 'offset': 32}, {'strength': 0.4, 'offset': 28}, {'strength': 0.4, 'offset': 10}, {'strength': 0.5, 'offset': 23}, {'strength': 0.3, 'offset': 16}, {'strength': 0.5, 'offset': -34}, {'strength': 0.4, 'offset': 29}, {'strength': 0.5, 'offset': 16}, {'strength': 0.4, 'offset': 6}, {'strength': 0.3, 'offset': 2}, {'strength': 0.5, 'offset': 52}, {'strength': 0.3, 'offset': 8}, {'strength': 0.3, 'offset': 24}, {'strength': 0.3, 'offset': -2}, {'strength': 0.3, 'offset': 10}, {'strength': 0.3, 'offset': -4}, {'strength': 0.4, 'offset': -117}, {'strength': 0.4, 'offset': 3}, {'strength': 0.4, 'offset': -13}, {'strength': 0.4, 'offset': -44}, {'strength': 0.3, 'offset': 56}, {'strength': 0.4, 'offset': -22}, {'strength': 0.4, 'offset': 47}, {'strength': 0.4, 'offset': 12}, {'strength': 0.3, 'offset': -4}, {'strength': 0.5, 'offset': 27}, {'strength': 0.4, 'offset': 13}, {'strength': 0.5, 'offset': 120}, {'strength': 0.4, 'offset': 11}, {'strength': 0.4, 'offset': 27}, {'strength': 0.5, 'offset': 30}, {'strength': 0.4, 'offset': -2}, {'strength': 0.5, 'offset': -48}, {'strength': 0.4, 'offset': -14}, {'strength': 0.5, 'offset': 39}, {'strength': 0.4, 'offset': -7}, {'strength': 0.4, 'offset': 13}, {'strength': 0.4, 'offset': -115}, {'strength': 0.5, 'offset': 25}, {'strength': 0.5, 'offset': -10}, {'strength': 0.5, 'offset': -14}, {'strength': 0.3, 'offset': 28}, {'strength': 0.5, 'offset': 28}, {'strength': 0.4, 'offset': 19}, {'strength': 0.3, 'offset': -1}, {'strength': 0.3, 'offset': 24}, {'strength': 0.4, 'offset': 25}, {'strength': 0.3, 'offset': -4}, {'strength': 0.5, 'offset': 3}, {'strength': 0.5, 'offset': 31}, {'strength': 0.5, 'offset': 20}, {'strength': 0.4, 'offset': -88}, {'strength': 0.5, 'offset': -89}, {'strength': 0.4, 'offset': 28}, {'strength': 0.5, 'offset': 15}, {'strength': 0.4, 'offset': -33}, {'strength': 0.4, 'offset': -14}, {'strength': 0.4, 'offset': 39}, {'strength': 0.5, 'offset': 21}, {'strength': 0.5, 'offset': 21}, {'strength': 0.5, 'offset': 15}, {'strength': 0.4, 'offset': -8}, {'strength': 0.4, 'offset': -61}, {'strength': 0.5, 'offset': -2}, {'strength': 0.3, 'offset': 10}, {'strength': 0.4, 'offset': 13}, {'strength': 0.3, 'offset': 26}, {'strength': 0.3, 'offset': -238}, {'strength': 0.5, 'offset': -2}, {'strength': 0.5, 'offset': 36}, {'strength': 0.5, 'offset': 71}, {'strength': 0.5, 'offset': 29}, {'strength': 0.4, 'offset': 25}, {'strength': 0.4, 'offset': 19}, {'strength': 0.4, 'offset': 26}, {'strength': 0.4, 'offset': 7}, {'strength': 0.4, 'offset': 32}, {'strength': 0.5, 'offset': -13}, {'strength': 0.4, 'offset': 17}, {'strength': 0.5, 'offset': 32}, {'strength': 0.5, 'offset': 13}, {'strength': 0.5, 'offset': 6}, {'strength': 0.5, 'offset': -3}, {'strength': 0.5, 'offset': -1}, {'strength': 0.3, 'offset': -117}, {'strength': 0.4, 'offset': 6}, {'strength': 0.5, 'offset': 19}, {'strength': 0.5, 'offset': 18}, {'strength': 0.3, 'offset': 35}, {'strength': 0.5, 'offset': 29}, {'strength': 0.4, 'offset': 58}, {'strength': 0.4, 'offset': 31}, {'strength': 0.5, 'offset': 16}, {'strength': 0.5, 'offset': -15}, {'strength': 0.5, 'offset': 22}, {'strength': 0.3, 'offset': 6}, {'strength': 0.4, 'offset': 1}, {'strength': 0.4, 'offset': 68}, {'strength': 0.5, 'offset': 11}, {'strength': 0.4, 'offset': 7}, {'strength': 0.5, 'offset': 19}, {'strength': 0.3, 'offset': 6}, {'strength': 0.4, 'offset': -73}, {'strength': 0.4, 'offset': -47}, {'strength': 0.5, 'offset': 29}, {'strength': 0.3, 'offset': 13}, {'strength': 0.5, 'offset': 14}, {'strength': 0.5, 'offset': -177}, {'strength': 0.4, 'offset': 21}, {'strength': 0.5, 'offset': -1}, {'strength': 0.4, 'offset': 3}, {'strength': 0.5, 'offset': 10}, {'strength': 0.4, 'offset': 34}, {'strength': 0.3, 'offset': -33}, {'strength': 0.3, 'offset': 85}, {'strength': 0.3, 'offset': 5}, {'strength': 0.5, 'offset': -44}, {'strength': 0.3, 'offset': 17}, {'strength': 0.4, 'offset': 7}, {'strength': 0.3, 'offset': -17}, {'strength': 0.4, 'offset': 9}, {'strength': 0.3, 'offset': -2}, {'strength': 0.4, 'offset': 1}, {'strength': 0.5, 'offset': 20}, {'strength': 0.4, 'offset': 15}, {'strength': 0.4, 'offset': 19}, {'strength': 0.5, 'offset': 11}, {'strength': 0.4, 'offset': 1}, {'strength': 0.3, 'offset': -111}, {'strength': 0.4, 'offset': 22}, {'strength': 0.5, 'offset': -2}, {'strength': 0.3, 'offset': 21}, {'strength': 0.3, 'offset': 43}, {'strength': 0.5, 'offset': 10}, {'strength': 0.5, 'offset': 60}, {'strength': 0.4, 'offset': 16}, {'strength': 0.4, 'offset': 20}, {'strength': 0.3, 'offset': 1}, {'strength': 0.5, 'offset': 31}, {'strength': 0.4, 'offset': -63}, {'strength': 0.4, 'offset': 22}, {'strength': 0.3, 'offset': 103}, {'strength': 0.5, 'offset': 20}, {'strength': 0.4, 'offset': 10}, {'strength': 0.5, 'offset': -6}, {'strength': 0.4, 'offset': -4}, {'strength': 0.5, 'offset': 11}, {'strength': 0.5, 'offset': -17}, {'strength': 0.5, 'offset': 25}, {'strength': 0.5, 'offset': 33}]
aar_end_offset = [{'strength': 0.4, 'offset': 21}, {'strength': 0.4, 'offset': 0}, {'strength': 0.3, 'offset': 16}, {'strength': 0.3, 'offset': 8}, {'strength': 0.5, 'offset': 32}, {'strength': 0.5, 'offset': -1}, {'strength': 0.5, 'offset': 18}, {'strength': 0.4, 'offset': 20}, {'strength': 0.3, 'offset': 23}, {'strength': 0.5, 'offset': 1}, {'strength': 0.5, 'offset': 19}, {'strength': 0.5, 'offset': 4}, {'strength': 0.5, 'offset': 9}, {'strength': 0.5, 'offset': 21}, {'strength': 0.3, 'offset': -64}, {'strength': 0.5, 'offset': 41}, {'strength': 0.5, 'offset': 7}, {'strength': 0.5, 'offset': 17}, {'strength': 0.4, 'offset': 24}, {'strength': 0.4, 'offset': 24}, {'strength': 0.3, 'offset': 25}, {'strength': 0.5, 'offset': 30}, {'strength': 0.3, 'offset': 29}, {'strength': 0.3, 'offset': 60}, {'strength': 0.4, 'offset': 23}, {'strength': 0.5, 'offset': 19}, {'strength': 0.5, 'offset': 4}, {'strength': 0.3, 'offset': -116}, {'strength': 0.3, 'offset': 13}, {'strength': 0.5, 'offset': -27}, {'strength': 0.5, 'offset': 14}, {'strength': 0.5, 'offset': 28}, {'strength': 0.4, 'offset': 91}, {'strength': 0.4, 'offset': 20}, {'strength': 0.3, 'offset': 10}, {'strength': 0.5, 'offset': 21}, {'strength': 0.3, 'offset': 22}, {'strength': 0.5, 'offset': 22}, {'strength': 0.4, 'offset': 104}, {'strength': 0.4, 'offset': 1}, {'strength': 0.5, 'offset': 5}, {'strength': 0.3, 'offset': 31}, {'strength': 0.5, 'offset': 1}, {'strength': 0.4, 'offset': 6}, {'strength': 0.5, 'offset': 17}, {'strength': 0.4, 'offset': 5}, {'strength': 0.3, 'offset': 16}, {'strength': 0.5, 'offset': 29}, {'strength': 0.3, 'offset': 15}, {'strength': 0.3, 'offset': 59}, {'strength': 0.3, 'offset': 18}, {'strength': 0.3, 'offset': 8}, {'strength': 0.3, 'offset': -52}, {'strength': 0.4, 'offset': 5}, {'strength': 0.4, 'offset': 11}, {'strength': 0.4, 'offset': -7}, {'strength': 0.4, 'offset': -78}, {'strength': 0.3, 'offset': 3}, {'strength': 0.4, 'offset': 17}, {'strength': 0.4, 'offset': 29}, {'strength': 0.4, 'offset': 20}, {'strength': 0.3, 'offset': 6}, {'strength': 0.5, 'offset': -1}, {'strength': 0.4, 'offset': -12}, {'strength': 0.5, 'offset': 26}, {'strength': 0.4, 'offset': 26}, {'strength': 0.4, 'offset': 13}, {'strength': 0.5, 'offset': 24}, {'strength': 0.4, 'offset': 22}, {'strength': 0.5, 'offset': 18}, {'strength': 0.4, 'offset': -145}, {'strength': 0.5, 'offset': 39}, {'strength': 0.4, 'offset': -13}, {'strength': 0.4, 'offset': 33}, {'strength': 0.4, 'offset': 23}, {'strength': 0.5, 'offset': -137}, {'strength': 0.5, 'offset': 21}, {'strength': 0.5, 'offset': 23}, {'strength': 0.3, 'offset': 48}, {'strength': 0.5, 'offset': 16}, {'strength': 0.4, 'offset': 18}, {'strength': 0.3, 'offset': 24}, {'strength': 0.3, 'offset': 18}, {'strength': 0.4, 'offset': 15}, {'strength': 0.3, 'offset': 13}, {'strength': 0.5, 'offset': -77}, {'strength': 0.5, 'offset': 15}, {'strength': 0.5, 'offset': 20}, {'strength': 0.4, 'offset': 20}, {'strength': 0.5, 'offset': 13}, {'strength': 0.4, 'offset': 13}, {'strength': 0.5, 'offset': 12}, {'strength': 0.4, 'offset': 28}, {'strength': 0.4, 'offset': 1}, {'strength': 0.4, 'offset': -3}, {'strength': 0.5, 'offset': 22}, {'strength': 0.5, 'offset': 7}, {'strength': 0.5, 'offset': -8}, {'strength': 0.4, 'offset': 1}, {'strength': 0.4, 'offset': 26}, {'strength': 0.5, 'offset': 38}, {'strength': 0.3, 'offset': 0}, {'strength': 0.4, 'offset': -6}, {'strength': 0.3, 'offset': -251}, {'strength': 0.3, 'offset': 12}, {'strength': 0.5, 'offset': 10}, {'strength': 0.5, 'offset': -5}, {'strength': 0.5, 'offset': 10}, {'strength': 0.5, 'offset': 16}, {'strength': 0.4, 'offset': 28}, {'strength': 0.4, 'offset': -78}, {'strength': 0.4, 'offset': 11}, {'strength': 0.4, 'offset': 18}, {'strength': 0.4, 'offset': -8}, {'strength': 0.5, 'offset': 2}, {'strength': 0.4, 'offset': 17}, {'strength': 0.5, 'offset': 26}, {'strength': 0.5, 'offset': 6}, {'strength': 0.5, 'offset': 18}, {'strength': 0.5, 'offset': 25}, {'strength': 0.5, 'offset': -30}, {'strength': 0.3, 'offset': 15}, {'strength': 0.4, 'offset': 12}, {'strength': 0.5, 'offset': 15}, {'strength': 0.5, 'offset': 25}, {'strength': 0.3, 'offset': 36}, {'strength': 0.5, 'offset': 51}, {'strength': 0.4, 'offset': 17}, {'strength': 0.4, 'offset': 259}, {'strength': 0.5, 'offset': 2}, {'strength': 0.5, 'offset': 38}, {'strength': 0.5, 'offset': -45}, {'strength': 0.3, 'offset': 18}, {'strength': 0.4, 'offset': 19}, {'strength': 0.4, 'offset': 14}, {'strength': 0.5, 'offset': 28}, {'strength': 0.4, 'offset': 21}, {'strength': 0.5, 'offset': 19}, {'strength': 0.3, 'offset': 20}, {'strength': 0.4, 'offset': 17}, {'strength': 0.4, 'offset': -70}, {'strength': 0.5, 'offset': -19}, {'strength': 0.3, 'offset': 30}, {'strength': 0.5, 'offset': -1}, {'strength': 0.5, 'offset': -15}, {'strength': 0.4, 'offset': 9}, {'strength': 0.5, 'offset': 23}, {'strength': 0.4, 'offset': 1}, {'strength': 0.5, 'offset': -159}, {'strength': 0.4, 'offset': 0}, {'strength': 0.3, 'offset': 3}, {'strength': 0.3, 'offset': 6}, {'strength': 0.3, 'offset': 19}, {'strength': 0.5, 'offset': 24}, {'strength': 0.3, 'offset': 32}, {'strength': 0.4, 'offset': 13}, {'strength': 0.3, 'offset': 31}, {'strength': 0.4, 'offset': 33}, {'strength': 0.3, 'offset': 45}, {'strength': 0.4, 'offset': 24}, {'strength': 0.5, 'offset': 4}, {'strength': 0.4, 'offset': -118}, {'strength': 0.4, 'offset': 5}, {'strength': 0.5, 'offset': 4}, {'strength': 0.4, 'offset': 16}, {'strength': 0.3, 'offset': 24}, {'strength': 0.4, 'offset': 1}, {'strength': 0.5, 'offset': 15}, {'strength': 0.3, 'offset': 18}, {'strength': 0.3, 'offset': 33}, {'strength': 0.5, 'offset': -3}, {'strength': 0.5, 'offset': 70}, {'strength': 0.4, 'offset': -163}, {'strength': 0.4, 'offset': 37}, {'strength': 0.3, 'offset': 17}, {'strength': 0.5, 'offset': -1}, {'strength': 0.4, 'offset': 27}, {'strength': 0.4, 'offset': 18}, {'strength': 0.3, 'offset': 11}, {'strength': 0.5, 'offset': -31}, {'strength': 0.4, 'offset': 9}, {'strength': 0.5, 'offset': 6}, {'strength': 0.4, 'offset': 29}, {'strength': 0.5, 'offset': 16}, {'strength': 0.5, 'offset': -17}, {'strength': 0.5, 'offset': 21}, {'strength': 0.5, 'offset': 15}]

import pandas as pd
import plotly.graph_objects as go
import numpy as np

# 计算每对start和end的平均值
def calculate_mean_offsets(start_offsets, end_offsets):
    mean_offsets = []
    # 确保start和end有相同的长度
    assert len(start_offsets) == len(end_offsets)
    
    for start, end in zip(start_offsets, end_offsets):
        # 确保strength相同
        assert start['strength'] == end['strength']
        mean_offset = {
            'strength': start['strength'],
            'offset': (start['offset'] + end['offset']) / 2
        }
        mean_offsets.append(mean_offset)
    return mean_offsets

# 计算两组数据的平均offset
kgw_mean_offsets = calculate_mean_offsets(kgw_start_offset, kgw_end_offset)
aar_mean_offsets = calculate_mean_offsets(aar_start_offset, aar_end_offset)

# 转换为DataFrame
kgw_df = pd.DataFrame(kgw_start_offset)
aar_df = pd.DataFrame(aar_start_offset)

# 添加数据来源标记
kgw_df['source'] = 'KGW'
aar_df['source'] = 'AAR'

# 创建新的x轴位置
# KGW组的位置在0,1,2
# AAR组的位置在4,5,6 (留出间隔)
kgw_positions = {
    '2.0': 0,
    '1.5': 1,
    '1.0': 2
}

aar_positions = {
    '0.5': 4,
    '0.4': 5,
    '0.3': 6
}

# 创建箱线图
fig = go.Figure()

# KGW的箱线图
fig.add_trace(go.Box(
    y=kgw_df['offset'],
    x=[kgw_positions[str(s)] for s in kgw_df['strength']],
    name='KGW',
    boxpoints='outliers',
))

# AAR的箱线图
fig.add_trace(go.Box(
    y=aar_df['offset'],
    x=[aar_positions[str(s)] for s in aar_df['strength']],
    name='AAR',
    boxpoints='outliers',
))

# 更新布局
fig.update_layout(
    yaxis_title={
        'text': 'Mean Offset',
        'font': {
            'family': 'Times New Roman',
            'size': 22,
            'color': 'black'
        }
    },
    font={
        'family': 'Times New Roman',
        'size': 20,
        'color': 'black'
    },
    width=700,  # 增加宽度以提高清晰度
    height=600,  # 增加高度以提高清晰度
    showlegend=True,
    legend={
        'font': {
            'family': 'Times New Roman',
            'size': 20,
            'color': 'black'
        }
    },
    # 自定义x轴标签
    xaxis={
        'ticktext': ['2.0', '1.5', '1.0', '', '0.5', '0.4', '0.3'],
        'tickvals': [0, 1, 2, 3, 4, 5, 6],
        'tickmode': 'array',
        'tickfont': {
            'family': 'Times New Roman',
            'size': 20,
            'color': 'black'
        },
    },
    # 添加KGW和AAR的标签
    annotations=[
        # KGW标签
        {
            'text': 'KGW',
            'x': 1,  # KGW组的中间位置
            'y': -0.15,  # 在x轴下方
            'showarrow': False,
            'font': {
                'family': 'Times New Roman',
                'size': 20,
                'color': 'black'
            },
            'xref': 'x',
            'yref': 'paper'
        },
        # AAR标签
        {
            'text': 'AAR',
            'x': 5,  # AAR组的中间位置
            'y': -0.15,  # 在x轴下方
            'showarrow': False,
            'font': {
                'family': 'Times New Roman',
                'size': 20,
                'color': 'black'
            },
            'xref': 'x',
            'yref': 'paper'
        },
        # Strength标签
        {
            'text': 'Strength',
            'x': 3,  # 整个x轴的中间位置
            'y': -0.22,  # 在KGW/AAR标签下方
            'showarrow': False,
            'font': {
                'family': 'Times New Roman',
                'size': 22,
                'color': 'black'
            },
            'xref': 'x',
            'yref': 'paper'
        },
    ],
    plot_bgcolor='white',
    paper_bgcolor='white',
    margin=dict(b=100)  # 增加底部边距以容纳标签
)

# 添加网格线
fig.update_yaxes(showgrid=True, gridwidth=1, gridcolor='lightgray')
fig.update_xaxes(showgrid=False)

# 保存图表
fig.write_image("fig/offset_boxplot.png")